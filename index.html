<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaburwo Coffee Disease Detection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --rust: #B7410E;
            --canker: #8B4513;
            --healthy: #4CAF50;
            --nematodes: #9C27B0;
            --phoma: #FF9800;
            --mite: #F44336;
            --cescospora: #2196F3;
            --vikoba: #3a7bd5;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            min-height: 100vh;
            color: #1f2937;
        }
        
        .header-gradient {
            background: linear-gradient(135deg, #065f46, #047857);
        }
        
        .chat-bubble {
            border-radius: 20px;
            padding: 12px 18px;
            max-width: 80%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            animation: fadeIn 0.3s ease-out;
            position: relative;
        }
        
        .user-bubble {
            background: linear-gradient(135deg, #047857, #065f46);
            color: white;
            border-bottom-right-radius: 5px;
        }
        
        .bot-bubble {
            background: white;
            color: #1f2937;
            border-bottom-left-radius: 5px;
        }
        
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.75rem;
            align-items: start;
        }
        
        .preview-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            position: relative;
        }
        
        .preview-item img {
            width: 100%;
            height: 110px;
            object-fit: cover;
            border-radius: 0.75rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .preview-item:hover img {
            transform: scale(1.05);
        }
        
        .result-badge {
            font-size: 0.85rem;
            padding: 0.25rem 0.5rem;
            border-radius: 999px;
            text-align: center;
            min-height: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .spinner {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .upload-area {
            transition: all 0.3s ease;
            border: 2px dashed #a7f3d0;
            background-color: #f0fdf4;
            cursor: pointer;
        }
        
        .upload-area:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(5, 150, 105, 0.15);
            border-color: #047857;
            background-color: #ecfdf5;
        }
        
        .analyze-btn {
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(5, 150, 105, 0.2);
            background: linear-gradient(135deg, #047857, #065f46);
            color: white;
            font-weight: 500;
        }
        
        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(5, 150, 105, 0.3);
            opacity: 0.95;
        }
        
        .analyze-btn:active {
            transform: translateY(1px);
        }
        
        .disease-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-block;
        }
        
        .disease-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .cescospora { background-color: #dbeafe; color: #1d4ed8; }
        .canker { background-color: #ede9fe; color: #5b21b6; }
        .rust { background-color: #ffedd5; color: #9a3412; }
        .healthy { background-color: #dcfce7; color: #166534; }
        .nematodes { background-color: #f3e8fd; color: #7e22ce; }
        .phoma { background-color: #fffbeb; color: #a16207; }
        .mite { background-color: #fee2e2; color: #b91c1c; }
        .vikoba-tag { background-color: #e0f7fa; color: #006064; }
        
        .disease-description {
            background-color: #f8fafc;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #047857;
        }
        
        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .disease-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .disease-card {
            border-radius: 0.75rem;
            padding: 1rem;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .disease-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .retry-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 500;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .retry-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(245, 158, 11, 0.3);
        }
        
        .cold-start-info {
            background-color: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        
        /* Vikoba styles */
        .vikoba-gradient {
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
        }
        
        .vikoba-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .vikoba-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .vikoba-header {
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
            color: white;
            padding: 15px;
        }
        
        .vikoba-members {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .member-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #e0f7fa;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: -10px;
            border: 2px solid white;
            overflow: hidden;
        }
        
        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .more-members {
            background-color: #00796b;
            color: white;
            font-size: 0.8rem;
        }
        
        .vikoba-stats {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            font-size: 0.9rem;
        }
        
        .vikoba-stat {
            text-align: center;
        }
        
        .vikoba-stat-value {
            font-weight: 700;
            font-size: 1.1rem;
            color: #3a7bd5;
        }
        
        .vikoba-actions {
            display: flex;
            gap: 8px;
            padding: 0 15px 15px;
        }
        
        .vikoba-btn {
            flex: 1;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .vikoba-btn:hover {
            background: #bbdefb;
            transform: translateY(-2px);
        }
        
        .create-vikoba {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: rgba(58, 123, 213, 0.05);
            border: 2px dashed rgba(58, 123, 213, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            height: 100%;
        }
        
        .create-vikoba:hover {
            background: rgba(58, 123, 213, 0.1);
            border-color: #3a7bd5;
        }
        
        .vikoba-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .vikoba-tab {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-top: 20px;
        }
        
        .vikoba-tab h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .vikoba-tab h3 i {
            margin-right: 10px;
        }
        
        .vikoba-training-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        
        .training-header {
            height: 120px;
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }
        
        .training-content {
            padding: 20px;
        }
        
        .training-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 15px;
        }
        
        .progress-container {
            margin-bottom: 15px;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
            border-radius: 4px;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #047857, #065f46);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .vikoba-share-btn {
            background: linear-gradient(135deg, #3a7bd5, #00d2ff);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 10px;
            gap: 0.5rem;
        }
        
        .vikoba-share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(58, 123, 213, 0.3);
        }
        
        /* New Auth Modal Styles */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .auth-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .auth-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            overflow: hidden;
        }
        
        .auth-modal.active .auth-content {
            transform: translateY(0);
        }
        
        .auth-header {
            background: linear-gradient(135deg, #047857, #065f46);
            color: white;
            padding: 20px;
            border-radius: 12px 12px 0 0;
            position: relative;
        }
        
        .close-auth {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .auth-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            padding: 4px;
            margin-top: 10px;
        }
        
        .auth-tab {
            flex: 1;
            padding: 8px;
            text-align: center;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            background: white;
            color: #047857;
        }
        
        .auth-body {
            padding: 20px;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #444;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .form-group input:focus {
            border-color: #047857;
            outline: none;
            box-shadow: 0 0 0 3px rgba(4, 120, 87, 0.1);
        }
        
        .auth-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #047857, #065f46);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .auth-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .auth-footer {
            text-align: center;
            padding: 15px 0;
            border-top: 1px solid #eee;
        }
        
        .switch-auth {
            color: #047857;
            cursor: pointer;
            font-weight: 500;
        }
        
        .vikoba-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3a7bd5;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        /* Demo image */
        .demo-image {
            width: 100%;
            border-radius: 0.5rem;
            margin: 1rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .grid-cols-1.lg\:grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .preview-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .disease-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Auth Modal -->
    <div class="auth-modal" id="auth-modal">
        <div class="auth-content">
            <div class="auth-header">
                <button class="close-auth" id="close-auth">
                    <i class="fas fa-times"></i>
                </button>
                <h2 class="text-xl font-bold text-center">Welcome to Kaburwo</h2>
                <div class="auth-tabs">
                    <div class="auth-tab active" data-tab="login">Login</div>
                    <div class="auth-tab" data-tab="signup">Sign Up</div>
                </div>
            </div>
            <div class="auth-body">
                <!-- Login Form -->
                <form class="auth-form active" id="login-form">
                    <div class="form-group">
                        <label for="login-phone">Phone Number</label>
                        <input type="tel" id="login-phone" placeholder="2547XXXXXXXX" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="auth-btn">Login to Account</button>
                </form>
                
                <!-- Signup Form -->
                <form class="auth-form" id="signup-form">
                    <div class="form-group">
                        <label for="signup-name">Full Name</label>
                        <input type="text" id="signup-name" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-phone">Phone Number</label>
                        <input type="tel" id="signup-phone" placeholder="2547XXXXXXXX" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-region">Region</label>
                        <select id="signup-region" required>
                            <option value="">Select your region</option>
                            <option value="nandi_north">Nandi North</option>
                            <option value="nandi_south">Nandi South</option>
                            <option value="nandi_east">Nandi East</option>
                            <option value="nandi_west">Nandi West</option>
                            <option value="nandi_central">Nandi Central</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <input type="password" id="signup-password" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-confirm">Confirm Password</label>
                        <input type="password" id="signup-confirm" placeholder="Confirm your password" required>
                    </div>
                    <button type="submit" class="auth-btn">Create Account</button>
                </form>
            </div>
            <div class="auth-footer">
                <p id="auth-footer-text">Don't have an account? <span class="switch-auth" data-target="signup">Sign Up</span></p>
            </div>
        </div>
    </div>

    <!-- Connection Status Indicator -->
    <div id="connection-status" class="connection-status bg-yellow-100 text-yellow-800 hidden">
        <i class="fas fa-circle-notch fa-spin mr-2"></i> Connecting to model...
    </div>
    
    <!-- Header -->
    <header class="header-gradient text-white p-4 shadow-lg">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center">
                <div class="bg-white/20 p-2 rounded-full mr-3">
                    <i class="fas fa-seedling text-xl"></i>
                </div>
                <h1 class="text-2xl font-bold">Kaburwo Coffee Advisor</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center bg-white/10 px-3 py-1 rounded-full">
                    <i class="fas fa-globe mr-2"></i>
                    <select id="language-selector" class="bg-transparent text-white py-1 focus:outline-none cursor-pointer">
                        <option value="en">English</option>
                        <option value="nd">Nandi</option>
                    </select>
                </div>
                <div id="user-profile" class="hidden">
                    <div class="flex items-center">
                        <img id="user-avatar" src="https://ui-avatars.com/api/?background=random&name=F" alt="User Profile" class="w-8 h-8 rounded-full border-2 border-white">
                        <span id="user-name" class="ml-2"></span>
                    </div>
                </div>
                <button id="auth-button" class="bg-white/20 hover:bg-white/30 transition-colors p-2 rounded-full">
                    <i class="fas fa-user"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 container mx-auto py-6 px-4">
        <!-- Tab Navigation -->
        <div class="tabs">
            <div class="tab active" data-tab="disease">Disease Detection</div>
            <div class="tab" data-tab="vikoba">Vikoba Groups</div>
            <div class="tab" data-tab="help">Help & Support</div>
        </div>
        
        <!-- Disease Detection Tab -->
        <div id="disease-tab" class="tab-content active">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Chat Panel -->
                <div class="bg-white rounded-xl shadow-xl overflow-hidden flex flex-col">
                    <div class="p-4 border-b">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-comments text-emerald-600 mr-2"></i>
                            Coffee Chat Assistant
                        </h2>
                        <p class="text-sm text-gray-500 mt-1">Get expert advice on coffee diseases</p>
                    </div>
                    
                    <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-[300px]">
                        <div class="flex justify-start">
                            <div class="chat-bubble bot-bubble">
                                <div class="font-medium">Hello! I'm your coffee disease expert. How can I help you today?</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-white border-t">
                        <div class="flex items-center space-x-2">
                            <input id="chat-input" type="text" placeholder="Ask about coffee diseases..." 
                                   class="flex-1 p-3 border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-colors">
                            <button id="send-button" class="p-3 rounded-full text-white bg-gradient-to-r from-emerald-600 to-emerald-800 shadow-lg hover:opacity-90 transition-opacity">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Image Analysis Panel -->
                <div class="bg-white rounded-xl shadow-xl p-6 flex flex-col">
                    <div class="pb-4 border-b">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-leaf text-emerald-600 mr-2"></i>
                            Coffee Disease Image Analysis
                        </h2>
                        <p class="text-sm text-gray-500 mt-1">Upload images of coffee leaves to detect diseases using our AI model</p>
                        
                        <!-- Model Status -->
                        <div class="mt-3 flex items-center">
                            <div id="model-status" class="flex items-center">
                                <span class="w-3 h-3 rounded-full bg-green-500 mr-2"></span>
                                <span class="text-sm">Model status: Connected and ready</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <!-- Single Image Upload -->
                        <div class="border rounded-xl p-4 bg-gradient-to-br from-white to-emerald-50 shadow-sm">
                            <h3 class="font-semibold text-lg text-emerald-800 mb-3 flex items-center">
                                <i class="fas fa-image mr-2"></i>
                                Single Image Analysis
                            </h3>
                            
                            <div class="upload-area rounded-xl p-6 text-center cursor-pointer mb-4" id="image-upload-area-single">
                                <div id="image-preview" class="hidden">
                                    <img alt="Uploaded photo" class="max-h-64 mx-auto rounded-lg shadow-md">
                                </div>
                                <div id="image-upload-placeholder" class="flex flex-col items-center">
                                    <i class="fas fa-cloud-upload-alt text-emerald-500 text-4xl mb-3"></i>
                                    <span class="text-emerald-700 font-medium">Upload a coffee leaf image</span>
                                    <span class="text-emerald-500 text-sm mt-1">Click to browse files</span>
                                </div>
                            </div>
                            
                            <button id="analyze-button" class="analyze-btn w-full py-3 rounded-full text-white font-medium">
                                <i class="fas fa-search mr-2"></i> Analyze with Model
                            </button>
                            
                            <div id="analysis-result" class="hidden mt-4 p-4 bg-emerald-50 rounded-lg border border-emerald-100">
                                <h3 class="font-bold text-emerald-800 mb-2 flex items-center">
                                    <i class="fas fa-clipboard-list mr-2"></i>
                                    Analysis Results:
                                </h3>
                                <div id="analysis-text" class="text-gray-700">
                                    <div class="font-bold text-lg rust disease-tag">Coffee Leaf Rust</div>
                                    <div class="flex items-center my-2">
                                        <div class="text-sm text-gray-600">Confidence: 92.5%</div>
                                    </div>
                                    <div class="mt-3">
                                        <div class="font-medium text-emerald-700">Recommended Action:</div>
                                        <p class="text-sm mt-1">Apply copper-based fungicides. Remove affected leaves to prevent spread. Ensure proper plant spacing for air circulation.</p>
                                    </div>
                                </div>
                                <!-- Vikoba share button -->
                                <div class="vikoba-share-btn" id="vikoba-share-btn">
                                    <i class="fas fa-share-alt"></i> Share with Vikoba Group
                                </div>
                            </div>
                        </div>
                        
                        <!-- Batch Image Upload -->
                        <div class="border rounded-xl p-4 bg-gradient-to-br from-white to-blue-50 shadow-sm">
                            <h3 class="font-semibold text-lg text-blue-800 mb-3 flex items-center">
                                <i class="fas fa-layer-group mr-2"></i>
                                Batch Image Analysis
                            </h3>
                            
                            <div class="mb-4">
                                <div class="upload-area rounded-xl p-4 text-center cursor-pointer mb-3" id="image-upload-area-multi">
                                    <div class="flex flex-col items-center py-4">
                                        <i class="fas fa-images text-blue-500 text-3xl mb-2"></i>
                                        <span class="text-blue-700 font-medium">Upload multiple coffee leaf images</span>
                                        <span class="text-blue-500 text-sm mt-1">Click to browse files</span>
                                    </div>
                                </div>
                                
                                <div id="preview-grid-multi" class="preview-grid mt-3 hidden"></div>
                            </div>
                            
                            <button id="analyze-button-multi" class="analyze-btn w-full py-3 rounded-full text-white font-medium">
                                <i class="fas fa-tasks mr-2"></i> Analyze All with Model
                            </button>
                            
                            <div id="analysis-result-multi" class="hidden mt-4 p-4 bg-blue-50 rounded-lg border border-blue-100 max-h-60 overflow-y-auto">
                                <h3 class="font-bold text-blue-800 mb-3 flex items-center">
                                    <i class="fas fa-list-check mr-2"></i>
                                    Batch Results
                                </h3>
                                <div id="analysis-text-multi" class="text-sm text-gray-700">
                                    <div class="flex items-center py-2 border-b border-blue-100">
                                        <div class="font-medium flex-1 truncate mr-2">leaf-1.jpg</div>
                                        <div class="font-semibold disease-tag rust">Coffee Leaf Rust</div>
                                        <div class="text-sm text-gray-500 ml-2">92%</div>
                                    </div>
                                    <div class="flex items-center py-2 border-b border-blue-100">
                                        <div class="font-medium flex-1 truncate mr-2">leaf-2.jpg</div>
                                        <div class="font-semibold disease-tag healthy">Healthy</div>
                                        <div class="text-sm text-gray-500 ml-2">98%</div>
                                    </div>
                                    <div class="flex items-center py-2 border-b border-blue-100">
                                        <div class="font-medium flex-1 truncate mr-2">leaf-3.jpg</div>
                                        <div class="font-semibold disease-tag cescospora">Cercospora Leaf Spot</div>
                                        <div class="text-sm text-gray-500 ml-2">87%</div>
                                    </div>
                                    <div class="mt-3 pt-3 border-t border-blue-200 font-medium">
                                        Processed 3 images
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Disease Information - Showing all 7 classes -->
                    <div class="mt-8 pt-4 border-t">
                        <h3 class="font-semibold text-lg text-gray-800 mb-3 flex items-center">
                            <i class="fas fa-book-medical mr-2 text-emerald-600"></i>
                            Coffee Disease Guide
                        </h3>
                        <div class="disease-grid">
                            <div class="disease-card cescospora">
                                <div class="font-bold text-lg disease-tag cescospora">Cercospora Leaf Spot</div>
                                <p class="text-sm mt-2">Fungal infection causing small, dark spots on leaves that can merge into larger lesions.</p>
                            </div>
                            <div class="disease-card canker">
                                <div class="font-bold text-lg disease-tag canker">Coffee Canker</div>
                                <p class="text-sm mt-2">Bacterial disease causing sunken lesions on stems and branches, leading to dieback.</p>
                            </div>
                            <div class="disease-card rust">
                                <div class="font-bold text-lg disease-tag rust">Coffee Leaf Rust</div>
                                <p class="text-sm mt-2">Fungal disease causing orange powdery spots on leaves. Reduces photosynthesis and yield.</p>
                            </div>
                            <div class="disease-card healthy">
                                <div class="font-bold text-lg disease-tag healthy">Healthy</div>
                                <p class="text-sm mt-2">Normal coffee plant with vibrant green leaves and no signs of disease or stress.</p>
                            </div>
                            <div class="disease-card nematodes">
                                <div class="font-bold text-lg disease-tag nematodes">Nematodes</div>
                                <p class="text-sm mt-2">Microscopic worms attacking roots, causing stunted growth and reduced nutrient uptake.</p>
                         </div>
                            <div class="disease-card phoma">
                                <div class="font-bold text-lg disease-tag phoma">Phoma Leaf Spot</div>
                                <p class="text-sm mt-2">Fungal disease causing irregular brown spots with yellow halos on leaves.</p>
                            </div>
                            <div class="disease-card mite">
                                <div class="font-bold text-lg disease-tag mite">Red Spider Mite</div>
                                <p class="text-sm mt-2">Tiny pests causing yellow stippling on leaves, leading to defoliation in severe cases.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Vikoba Groups Tab -->
        <div id="vikoba-tab" class="tab-content">
            <div class="bg-white rounded-xl shadow-xl p-6">
                <div class="flex justify-between items-center flex-wrap gap-4">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-users text-blue-500 mr-2"></i>
                            Vikoba Groups
                        </h2>
                        <p class="text-gray-600 mt-1">Collaborate with farmers in your region</p>
                    </div>
                    <button id="create-vikoba" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center">
                        <i class="fas fa-plus mr-2"></i> Create New Vikoba
                    </button>
                </div>
                
                <div id="vikoba-info" class="mt-4">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <h3 class="font-bold text-blue-700 flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            Your Regional Vikoba Group
                        </h3>
                        <p class="text-blue-600 mt-2">
                            You've been automatically assigned to a Vikoba group based on your region. 
                            Farmers in your region collaborate to share knowledge and resources.
                        </p>
                    </div>
                    
                    <div id="vikoba-container" class="mt-6">
                        <!-- Vikoba group will be dynamically inserted here -->
                        <div class="vikoba-card relative">
                            <div class="vikoba-badge">Nandi Central</div>
                            <div class="vikoba-header">
                                <h3 class="text-lg font-bold">Nandi Central Collective</h3>
                                <p class="text-sm opacity-90">VK-005 | 5/5 members</p>
                            </div>
                            <div class="vikoba-members">
                                <div class="member-avatar">
                                    <img src="https://ui-avatars.com/api/?name=Amos+Kipruto&background=random" alt="Amos Kipruto">
                                </div>
                                <div class="member-avatar">
                                    <img src="https://ui-avatars.com/api/?name=Peruth+Chemutai&background=random" alt="Peruth Chemutai">
                                </div>
                                <div class="member-avatar">
                                    <img src="https://ui-avatars.com/api/?name=Ferguson+Rotich&background=random" alt="Ferguson Rotich">
                                </div>
                                <div class="member-avatar">
                                    <img src="https://ui-avatars.com/api/?name=Beatrice+Chepkoech&background=random" alt="Beatrice Chepkoech">
                                </div>
                                <div class="member-avatar">
                                    <img src="https://ui-avatars.com/api/?name=Timothy+Cheruiyot&background=random" alt="Timothy Cheruiyot">
                                </div>
                            </div>
                            <div class="vikoba-stats">
                                <div class="vikoba-stat">
                                    <div class="vikoba-stat-value">KES 49,800</div>
                                    <div class="text-gray-600">Group Funds</div>
                                </div>
                                <div class="vikoba-stat">
                                    <div class="vikoba-stat-value">5</div>
                                    <div class="text-gray-600">Projects</div>
                                </div>
                            </div>
                            <div class="vikoba-actions">
                                <div class="vikoba-btn">
                                    <i class="fas fa-comment mr-1"></i> Chat
                                </div>
                                <div class="vikoba-btn">
                                    <i class="fas fa-eye mr-1"></i> View
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Training Section -->
                <div class="vikoba-tab mt-8">
                    <h3><i class="fas fa-graduation-cap"></i> Group Training Programs</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div class="vikoba-training-card">
                            <div class="training-header">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="training-content">
                                <h4 class="font-bold text-lg">Crop Rotation Techniques</h4>
                                <div class="training-meta">
                                    <span><i class="fas fa-clock mr-1"></i> 45 min</span>
                                    <span><i class="fas fa-users mr-1"></i> Group Training</span>
                                </div>
                                <p class="text-gray-600 mb-4">Learn sustainable crop rotation methods to improve soil health and yield.</p>
                                <div class="progress-container">
                                    <div class="progress-label">
                                        <span>Group Progress</span>
                                        <span>65%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress" style="width: 65%"></div>
                                    </div>
                                </div>
                                <button class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">
                                    <i class="fas fa-play-circle mr-2"></i> Continue Training
                                </button>
                            </div>
                        </div>
                        
                        <div class="vikoba-training-card">
                            <div class="training-header">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="training-content">
                                <h4 class="font-bold text-lg">Efficient Irrigation Systems</h4>
                                <div class="training-meta">
                                    <span><i class="fas fa-clock mr-1"></i> 30 min</span>
                                    <span><i class="fas fa-users mr-1"></i> Group Training</span>
                                </div>
                                <p class="text-gray-600 mb-4">Master water conservation techniques and modern irrigation methods.</p>
                                <div class="progress-container">
                                    <div class="progress-label">
                                        <span>Group Progress</span>
                                        <span>40%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress" style="width: 40%"></div>
                                    </div>
                                </div>
                                <button class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">
                                    <i class="fas fa-play-circle mr-2"></i> Start Training
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Funding Section -->
                <div class="vikoba-tab mt-8">
                    <h3><i class="fas fa-money-bill-wave"></i> Group Funding Opportunities</h3>
                    <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                        <div class="flex items-start">
                            <div class="bg-blue-100 p-3 rounded-full mr-4">
                                <i class="fas fa-hand-holding-usd text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg">Agricultural Development Fund</h4>
                                <p class="text-gray-600 mt-2">Apply for group funding to implement sustainable farming practices and disease management.</p>
                                <div class="flex mt-4 flex-wrap gap-4">
                                    <div>
                                        <div class="text-blue-600 font-bold">KES 100,000</div>
                                        <div class="text-sm text-gray-500">Max Funding</div>
                                    </div>
                                    <div>
                                        <div class="text-blue-600 font-bold">15 Days Left</div>
                                        <div class="text-sm text-gray-500">Application Deadline</div>
                                    </div>
                                </div>
                                <button class="mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                    Apply as Vikoba Group
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Help & Support Tab -->
        <div id="help-tab" class="tab-content">
            <div class="bg-white rounded-xl shadow-xl p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-question-circle text-blue-500 mr-2"></i>
                    Help & Support
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 p-6 rounded-xl">
                        <h3 class="font-bold text-lg text-blue-700 mb-3">
                            <i class="fas fa-camera mr-2"></i> Taking Good Photos
                        </h3>
                        <ul class="list-disc pl-5 space-y-2 text-gray-700">
                            <li>Take photos in natural daylight</li>
                            <li>Place leaf on a plain dark background</li>
                            <li>Get close enough to show disease details</li>
                            <li>Capture both sides of the leaf</li>
                            <li>Avoid shadows on the leaf surface</li>
                        </ul>
                        <img src="https://images.unsplash.com/photo-1592409065737-a253f29069d0?q=80&w=500&auto=format&fit=crop" alt="Coffee leaf photography" class="demo-image">
                    </div>
                    
                    <div class="bg-emerald-50 p-6 rounded-xl">
                        <h3 class="font-bold text-lg text-emerald-700 mb-3">
                            <i class="fas fa-leaf mr-2"></i> Identifying Diseases
                        </h3>
                        <ul class="list-disc pl-5 space-y-2 text-gray-700">
                            <li>Examine leaves regularly for early detection</li>
                            <li>Look for spots, discoloration, or powdery substances</li>
                            <li>Check for curling or wilting leaves</li>
                            <li>Inspect stems and branches for lesions</li>
                            <li>Monitor plant growth and yield changes</li>
                        </ul>
                        <div class="mt-4">
                            <h4 class="font-medium text-emerald-700 mb-2">Common Symptoms:</h4>
                            <div class="flex flex-wrap gap-2">
                                <span class="disease-tag rust">Rust-colored spots</span>
                                <span class="disease-tag cescospora">Dark leaf spots</span>
                                <span class="disease-tag mite">Yellow stippling</span>
                                <span class="disease-tag canker">Stem lesions</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-amber-50 p-6 rounded-xl md:col-span-2">
                        <h3 class="font-bold text-lg text-amber-700 mb-3">
                            <i class="fas fa-headset mr-2"></i> Contact Support
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="text-amber-600 text-2xl mb-2">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <h4 class="font-bold mb-1">Phone Support</h4>
                                <p class="text-sm text-gray-600">+254 700 123 456</p>
                                <p class="text-xs text-gray-500 mt-1">Mon-Fri, 8am-5pm</p>
                            </div>
                            
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="text-amber-600 text-2xl mb-2">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <h4 class="font-bold mb-1">Email Support</h4>
                                <p class="text-sm text-gray-600">support@kaburwo.co.ke</p>
                                <p class="text-xs text-gray-500 mt-1">Response within 24 hours</p>
                            </div>
                            
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="text-amber-600 text-2xl mb-2">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <h4 class="font-bold mb-1">Community Forum</h4>
                                <p class="text-sm text-gray-600">Join farmer discussions</p>
                                <a href="#" class="text-amber-600 text-xs mt-1 block">Visit Forum </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-8">
        <div class="container mx-auto px-4 text-center">
            <div class="flex justify-center space-x-6 mb-4">
                <a href="#" class="hover:text-emerald-400 transition-colors"><i class="fab fa-github"></i></a>
                <a href="#" class="hover:text-emerald-400 transition-colors"><i class="fab fa-twitter"></i></a>
                <a href="#" class="hover:text-emerald-400 transition-colors"><i class="fab fa-facebook"></i></a>
                <a href="#" class="hover:text-emerald-400 transition-colors"><i class="fab fa-instagram"></i></a>
            </div>
            <p class="text-sm text-gray-400"> 2023 Kaburwo Coffee Disease Detection. All rights reserved.</p>
            <p class="text-xs text-gray-500 mt-2">Accurately detecting all 7 coffee disease classes</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const authModal = document.getElementById('auth-modal');
            const closeAuth = document.getElementById('close-auth');
            const authButton = document.getElementById('auth-button');
            const authTabs = document.querySelectorAll('.auth-tab');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const switchAuth = document.querySelectorAll('.switch-auth');
            const authFooterText = document.getElementById('auth-footer-text');
            const userProfile = document.getElementById('user-profile');
            const userName = document.getElementById('user-name');
            const userAvatar = document.getElementById('user-avatar');
            const vikobaContainer = document.getElementById('vikoba-container');
            const createVikobaBtn = document.getElementById('create-vikoba');
            
            // User state
            let currentUser = null;
            const regions = {
                nandi_north: "Nandi North",
                nandi_south: "Nandi South",
                nandi_east: "Nandi East",
                nandi_west: "Nandi West",
                nandi_central: "Nandi Central"
            };
            
            // Chat elements
            const chatMessages = document.getElementById('chat-messages');
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');
            
            // Tabs
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Image elements
            const imageUploadAreaSingle = document.getElementById('image-upload-area-single');
            const imageUploadAreaMulti = document.getElementById('image-upload-area-multi');
            const analyzeButton = document.getElementById('analyze-button');
            const analyzeButtonMulti = document.getElementById('analyze-button-multi');
            const analysisResult = document.getElementById('analysis-result');
            const analysisResultMulti = document.getElementById('analysis-result-multi');
            const vikobaShareBtn = document.getElementById('vikoba-share-btn');
            
            // Show auth modal
            authButton.addEventListener('click', function() {
                authModal.classList.add('active');
            });
            
            // Close auth modal
            closeAuth.addEventListener('click', function() {
                authModal.classList.remove('active');
            });
            
            // Switch between login/signup tabs
            authTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Update active tab
                    authTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show correct form
                    loginForm.classList.remove('active');
                    signupForm.classList.remove('active');
                    document.getElementById(`${tabName}-form`).classList.add('active');
                    
                    // Update footer text
                    if (tabName === 'login') {
                        authFooterText.innerHTML = `Don't have an account? <span class="switch-auth" data-target="signup">Sign Up</span>`;
                    } else {
                        authFooterText.innerHTML = `Already have an account? <span class="switch-auth" data-target="login">Login</span>`;
                    }
                });
            });
            
            // Switch auth forms
            switchAuth.forEach(link => {
                link.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    
                    // Update active tab
                    authTabs.forEach(t => t.classList.remove('active'));
                    document.querySelector(`.auth-tab[data-tab="${target}"]`).classList.add('active');
                    
                    // Show correct form
                    loginForm.classList.remove('active');
                    signupForm.classList.remove('active');
                    document.getElementById(`${target}-form`).classList.add('active');
                    
                    // Update footer text
                    if (target === 'login') {
                        authFooterText.innerHTML = `Don't have an account? <span class="switch-auth" data-target="signup">Sign Up</span>`;
                    } else {
                        authFooterText.innerHTML = `Already have an account? <span class="switch-auth" data-target="login">Login</span>`;
                    }
                });
            });
            
            // Handle login
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const phone = document.getElementById('login-phone').value;
                const password = document.getElementById('login-password').value;
                
                // Simple validation
                if (!phone || !password) {
                    alert('Please fill in all fields');
                    return;
                }
                
                // Simulate login
                simulateLogin(phone, password);
            });
            
            // Handle signup
            signupForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('signup-name').value;
                const phone = document.getElementById('signup-phone').value;
                const region = document.getElementById('signup-region').value;
                const password = document.getElementById('signup-password').value;
                const confirm = document.getElementById('signup-confirm').value;
                
                // Validation
                if (!name || !phone || !region || !password || !confirm) {
                    alert('Please fill in all fields');
                    return;
                }
                
                if (password !== confirm) {
                    alert('Passwords do not match');
                    return;
                }
                
                if (password.length < 6) {
                    alert('Password must be at least 6 characters');
                    return;
                }
                
                // Simulate signup
                simulateSignup(name, phone, region, password);
            });
            
            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab contents
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Show the selected tab content
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Image upload area click handlers
            imageUploadAreaSingle.addEventListener('click', () => {
                alert("In a real application, this would open a file dialog to select an image");
                // For demo purposes, show a preview
                const preview = imageUploadAreaSingle.querySelector('#image-preview');
                const placeholder = imageUploadAreaSingle.querySelector('#image-upload-placeholder');
                placeholder.classList.add('hidden');
                preview.classList.remove('hidden');
                preview.querySelector('img').src = "https://images.unsplash.com/photo-1592409065737-a253f29069d0?q=80&w=500&auto=format&fit=crop";
            });
            
            imageUploadAreaMulti.addEventListener('click', () => {
                alert("In a real application, this would open a file dialog to select multiple images");
                // For demo purposes, show a preview grid
                const previewGrid = document.getElementById('preview-grid-multi');
                previewGrid.classList.remove('hidden');
                
                // Clear previous
                previewGrid.innerHTML = '';
                
                // Add demo images
                for (let i = 0; i < 3; i++) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="https://images.unsplash.com/photo-1592409065737-a253f29069d0?q=80&w=500&auto=format&fit=crop" alt="Coffee leaf">
                        <div class="text-xs text-gray-600 truncate max-w-full">leaf-${i+1}.jpg</div>
                        <div class="result-badge bg-gray-100 text-gray-800">Pending</div>
                    `;
                    previewGrid.appendChild(previewItem);
                }
            });
            
            // Analyze buttons
            analyzeButton.addEventListener('click', function() {
                // Show loading state
                const originalText = analyzeButton.innerHTML;
                analyzeButton.innerHTML = '<div class="spinner mr-2"></div> Analyzing...';
                analyzeButton.disabled = true;
                
                // Simulate analysis
                setTimeout(() => {
                    analysisResult.classList.remove('hidden');
                    analyzeButton.innerHTML = originalText;
                    analyzeButton.disabled = false;
                }, 1500);
            });
            
            analyzeButtonMulti.addEventListener('click', function() {
                // Show loading state
                const originalText = analyzeButtonMulti.innerHTML;
                analyzeButtonMulti.innerHTML = '<div class="spinner mr-2"></div> Processing...';
                analyzeButtonMulti.disabled = true;
                
                // Update badges in preview grid
                const badges = document.querySelectorAll('#preview-grid-multi .result-badge');
                badges.forEach(badge => {
                    badge.textContent = "Processing...";
                    badge.className = "result-badge bg-blue-100 text-blue-800";
                });
                
                // Simulate analysis
                setTimeout(() => {
                    analysisResultMulti.classList.remove('hidden');
                    analyzeButtonMulti.innerHTML = originalText;
                    analyzeButtonMulti.disabled = false;
                    
                    // Update badges with demo results
                    const results = [
                        {disease: "Coffee Leaf Rust", confidence: "92%", class: "rust"},
                        {disease: "Healthy", confidence: "98%", class: "healthy"},
                        {disease: "Cercospora Leaf Spot", confidence: "87%", class: "cescospora"}
                    ];
                    
                    badges.forEach((badge, index) => {
                        if (results[index]) {
                            badge.textContent = results[index].disease;
                            badge.className = `result-badge ${results[index].class}`;
                        }
                    });
                }, 2000);
            });
            
            // Vikoba share button
            vikobaShareBtn.addEventListener('click', function() {
                // Switch to Vikoba tab
                tabs.forEach(t => t.classList.remove('active'));
                document.querySelector('.tab[data-tab="vikoba"]').classList.add('active');
                
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById('vikoba-tab').classList.add('active');
                
                // Show success message
                showNotification(`Disease result shared with your Vikoba group!`);
            });
            
            // Handle sending chat messages
            function handleSendMessage() {
                const userInput = chatInput.value.trim();
                if (userInput) {
                    addMessage('user', userInput);
                    chatInput.value = '';
                    
                    // Simulate bot response
                    setTimeout(() => {
                        const responses = [
                            "Coffee leaf rust appears as yellow-orange powdery spots on the undersides of leaves. It's caused by the fungus Hemileia vastatrix.",
                            "For coffee leaf rust, I recommend removing affected leaves and applying copper-based fungicides. Ensure proper plant spacing for air circulation.",
                            "Healthy coffee leaves should be vibrant green without spots or discoloration. Regular monitoring helps detect issues early.",
                            "The best time to apply fungicides is during the rainy season when humidity is high. Apply every 2-3 weeks for maximum effectiveness."
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addMessage('bot', randomResponse);
                    }, 1000);
                }
            }
            
            sendButton.addEventListener('click', handleSendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSendMessage();
            });
            
            // Helper function to add a message to the chat
            function addMessage(role, content) {
                const messageContainer = document.createElement('div');
                messageContainer.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'}`;
                
                const bubble = document.createElement('div');
                bubble.className = `chat-bubble ${role === 'user' ? 'user-bubble' : 'bot-bubble'}`;
                bubble.textContent = content;
                
                messageContainer.appendChild(bubble);
                chatMessages.appendChild(messageContainer);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Simulate login (for demo)
            function simulateLogin(phone, password) {
                // For demo, we'll just create a user
                const user = {
                    name: "Demo Farmer",
                    phone: phone,
                    region: "nandi_central"
                };
                
                setCurrentUser(user);
                authModal.classList.remove('active');
                
                // Show success message
                showNotification(`Welcome back, ${user.name}!`);
            }
            
            // Simulate signup (for demo)
            function simulateSignup(name, phone, region, password) {
                const user = {
                    name: name,
                    phone: phone,
                    region: region
                };
                
                setCurrentUser(user);
                authModal.classList.remove('active');
                
                // Show success message
                showNotification(`Account created! Welcome to Kaburwo, ${name}`);
            }
            
            // Set current user
            function setCurrentUser(user) {
                currentUser = user;
                
                // Show user profile
                userProfile.classList.remove('hidden');
                userName.textContent = user.name;
                userAvatar.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=random`;
                authButton.classList.add('hidden');
            }
            
            // Show notification
            function showNotification(message) {
                const notification = document.createElement('div');
                notification.className = "fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50";
                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-check-circle mr-2"></i>
                        ${message}
                    </div>
                `;
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
            
            // Add initial chat message
            addMessage('bot', "Hello! I'm your coffee disease expert. I can help you identify and manage common coffee plant diseases. How can I help you today?");
        });
    </script>
</body>
</html>
